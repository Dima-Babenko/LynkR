<style>
  .discord-message {
    background-color: #36393f;
    color: #dcddde;
    padding: 12px 16px;
    border-radius: 8px;
    margin-bottom: 15px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }
  .discord-message strong {
    color: #fff;
    font-weight: 600;
  }
  .discord-message p {
    margin: 6px 0;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  .discord-message img, .discord-message video, .discord-message audio {
    margin-top: 8px;
    border-radius: 6px;
    max-width: 100%;
    height: auto;
    display: block;
  }
  .discord-message small {
    display: block;
    margin-top: 8px;
    color: #72767d;
    font-size: 0.75rem;
  }
  a.discord-attachment-link {
    color: #00aff4;
    text-decoration: none;
    font-weight: 600;
  }
  a.discord-attachment-link:hover {
    text-decoration: underline;
  }
</style>

{% for message in messages %}
  <div class="discord-message">
    <p><strong>{{ message.sender.username }}:</strong></p>
    <p>{{ message.text|linebreaksbr }}</p>

    {% if message.file %}
      {% with message.file.name|lower as filename %}
        {% if ".jpg" in filename or ".jpeg" in filename or ".png" in filename or ".gif" in filename %}
          <img src="{{ message.file.url }}" alt="Зображення">
        {% elif ".mp3" in filename %}
          <audio controls>
            <source src="{{ message.file.url }}" type="audio/mpeg">
            Ваш браузер не підтримує аудіо.
          </audio>
        {% elif ".mp4" in filename %}
          <video controls>
            <source src="{{ message.file.url }}" type="video/mp4">
            Ваш браузер не підтримує відео.
          </video>
        {% else %}
          <p><a href="{{ message.file.url }}" target="_blank" class="discord-attachment-link">📎 Завантажити файл</a></p>
        {% endif %}
      {% endwith %}
    {% endif %}

    <small>{{ message.timestamp|date:"d.m.Y H:i" }}</small>
  </div>
{% empty %}
  <p style="color:#72767d; font-style: italic;">Немає повідомлень.</p>
{% endfor %}
