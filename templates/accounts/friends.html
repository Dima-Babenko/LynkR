{% extends 'base.html' %}
{% block content %}

<h2>–î—Ä—É–∑—ñ</h2>
{% if friends %}
<ul>
    {% for friend in friends %}
        <li>{{ friend.username }} ({{ friend.friend_id }})</li>
    {% endfor %}
</ul>
{% else %}
<p>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –¥—Ä—É–∑—ñ–≤.</p>
{% endif %}

<hr>

<h3>–ó–Ω–∞–π—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ friend ID</h3>
<form method="get" action="{% url 'friends' %}">
    <input type="text" name="friend_id" placeholder="–í–≤–µ–¥—ñ—Ç—å friend ID">
    <button type="submit">–ó–Ω–∞–π—Ç–∏</button>
</form>

{% if found_user %}
    <hr>
    <h3>–ó–Ω–∞–π–¥–µ–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á:</h3>
    <p><strong>{{ found_user.username }}</strong> ({{ found_user.friend_id }})</p>

    {% if already_friends %}
        <p>‚úÖ –í–∏ –≤–∂–µ –¥—Ä—É–∑—ñ!</p>
    {% elif already_subscribed %}
        <p>üîî –í–∏ –≤–∂–µ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –Ω–∞ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –û—á—ñ–∫—É—î—Ç—å—Å—è –ø—ñ–¥–ø–∏—Å–∫–∞ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å.</p>
    {% else %}
        <form method="post" action="{% url 'subscribe' %}">
            {% csrf_token %}
            <input type="hidden" name="friend_id" value="{{ found_user.friend_id }}">
            <button type="submit">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å</button>
        </form>
    {% endif %}
{% endif %}

<hr>

<h3>–í–∞—à—ñ –ø—ñ–¥–ø–∏—Å–∫–∏</h3>
<ul>
    {% for sub in user.following.all %}
        <li>{{ sub.following.username }} ({{ sub.following.friend_id }})</li>
    {% empty %}
        <li>–ù–µ–º–∞—î –ø—ñ–¥–ø–∏—Å–æ–∫.</li>
    {% endfor %}
</ul>

<h3>–í–∞—à—ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏</h3>
<ul>
    {% for sub in user.followers.all %}
        <li>{{ sub.follower.username }} ({{ sub.follower.friend_id }})</li>
    {% empty %}
        <li>–ù–µ–º–∞—î –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤.</li>
    {% endfor %}
</ul>

<hr>
<h3>–ü—ñ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ –≤–∞—Å, –∞–ª–µ –≤–∏ —â–µ –Ω–µ –ø—ñ–¥–ø–∏—Å–∞–ª–∏—Å—å:</h3>
<ul>
    {% for sub in user.followers.all %}
        {% if sub.follower.id not in following_ids %}
            <li>
                {{ sub.follower.username }} ({{ sub.follower.friend_id }})
                <form method="post" action="{% url 'subscribe' %}" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="friend_id" value="{{ sub.follower.friend_id }}">
                    <button type="submit">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</button>
                </form>
            </li>
        {% endif %}
    {% empty %}
        <li>–ù–µ–º–∞—î –Ω–æ–≤–∏—Ö –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤.</li>
    {% endfor %}
</ul>

{% endblock %}
